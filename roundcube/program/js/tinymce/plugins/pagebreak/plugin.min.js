!function(){"use strict";function e(){return"mce-pagebreak"}function n(){return'<img src="'+t.transparentSrc+'" class="'+e()+'" data-mce-resize="false" data-mce-placeholder />'}var a=tinymce.util.Tools.resolve("tinymce.PluginManager"),t=tinymce.util.Tools.resolve("tinymce.Env"),o=function(e){return e.getParam("pagebreak_separator","\x3c!-- pagebreak --\x3e")},i=function(e){return e.getParam("pagebreak_split_block",!1)},r=function(r){var c=o(r),a=new RegExp(c.replace(/[\?\.\*\[\]\(\)\{\}\+\^\$\:]/g,function(e){return"\\"+e}),"gi");r.on("BeforeSetContent",function(e){e.content=e.content.replace(a,n())}),r.on("PreInit",function(){r.serializer.addNodeFilter("img",function(e){for(var a,n,t=e.length;t--;)(n=(a=e[t]).attr("class"))&&-1!==n.indexOf("mce-pagebreak")&&(n=a.parent,r.schema.getBlockElements()[n.name]&&i(r)?(n.type=3,n.value=c,n.raw=!0,a.remove()):(a.type=3,a.value=c,a.raw=!0))})})},c=n,g=e,s=function(e){e.addCommand("mcePageBreak",function(){e.settings.pagebreak_split_block?e.insertContent("<p>"+c()+"</p>"):e.insertContent(c())})},u=function(a){a.on("ResolveName",function(e){"IMG"===e.target.nodeName&&a.dom.hasClass(e.target,g())&&(e.name="pagebreak")})},l=function(e){e.addButton("pagebreak",{title:"Page break",cmd:"mcePageBreak"}),e.addMenuItem("pagebreak",{text:"Page break",icon:"pagebreak",cmd:"mcePageBreak",context:"insert"})};a.add("pagebreak",function(e){s(e),l(e),r(e),u(e)})}();