!function(){"use strict";function e(t){return t.getParam("textcolor_map",b)}function o(t){return t.getParam("textcolor_rows",5)}function r(t){return t.getParam("textcolor_cols",8)}function n(t){return t.getParam("color_picker_callback",null)}function i(t,e){t.style.background=e,t.setAttribute("data-mce-color",e)}function a(e){return function(t){t=t.control;t._color?e.execCommand("mceApplyTextcolor",t.settings.format,t._color):e.execCommand("mceRemoveTextcolor",t.settings.format)}}function l(o,c){return function(t){function a(t){o.execCommand("mceApplyTextcolor",l.settings.format,t),l.hidePanel(),l.color(t)}var l=this.parent(),e=u(o,l.settings.format);g.DOM.getParent(t.target,".mce-custom-color-btn")&&(l.hidePanel(),k(o).call(o,function(t){for(var e,o=l.panel.getEl().getElementsByTagName("table")[0],r=F.map(o.rows[o.rows.length-1].childNodes,function(t){return t.firstChild}),n=0;n<r.length&&(e=r[n]).getAttribute("data-mce-color");n++);if(n===c)for(n=0;n<c-1;n++)i(r[n],r[n+1].getAttribute("data-mce-color"));i(e,t),a(t)},e)),(e=t.target.getAttribute("data-mce-color"))?(this.lastId&&g.DOM.get(this.lastId).setAttribute("aria-selected","false"),t.target.setAttribute("aria-selected",!0),this.lastId=t.target.id,"transparent"===e?(o.execCommand("mceRemoveTextcolor",l.settings.format),l.hidePanel(),l.resetColor()):a(e)):null!==e&&l.hidePanel()}}function c(n,a){return function(){var t=(a?v:P)(n),e=(a?y:h)(n),o=(a?p:C)(n),r=x(n);return _(t,e,o,r)}}var t=tinymce.util.Tools.resolve("tinymce.PluginManager"),u=function(t,e){var o;return t.dom.getParents(t.selection.getStart(),function(t){(t=t.style["forecolor"===e?"color":"background-color"])&&(o=o||t)}),o},f=function(t){for(var e=[],o=0;o<t.length;o+=2)e.push({text:t[o+1],color:"#"+t[o]});return e},m=function(t,e,o){t.undoManager.transact(function(){t.focus(),t.formatter.apply(e,{value:o}),t.nodeChanged()})},s=function(t,e){t.undoManager.transact(function(){t.focus(),t.formatter.remove(e,{value:null},null,!0),t.nodeChanged()})},d=function(o){o.addCommand("mceApplyTextcolor",function(t,e){m(o,t,e)}),o.addCommand("mceRemoveTextcolor",function(t){s(o,t)})},g=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),F=tinymce.util.Tools.resolve("tinymce.util.Tools"),b=["000000","Black","993300","Burnt orange","333300","Dark olive","003300","Dark green","003366","Dark azure","000080","Navy Blue","333399","Indigo","333333","Very dark gray","800000","Maroon","FF6600","Orange","808000","Olive","008000","Green","008080","Teal","0000FF","Blue","666699","Grayish blue","808080","Gray","FF0000","Red","FF9900","Amber","99CC00","Yellow green","339966","Sea green","33CCCC","Turquoise","3366FF","Royal blue","800080","Purple","999999","Medium gray","FF00FF","Magenta","FFCC00","Gold","FFFF00","Yellow","00FF00","Lime","00FFFF","Aqua","00CCFF","Sky blue","993366","Red violet","FFFFFF","White","FF99CC","Pink","FFCC99","Peach","FFFF99","Light yellow","CCFFCC","Pale green","CCFFFF","Pale cyan","99CCFF","Light sky blue","CC99FF","Plum"],p=function(t){return t.getParam("forecolor_map",e(t))},C=function(t){return t.getParam("backcolor_map",e(t))},y=function(t){return t.getParam("forecolor_rows",o(t))},h=function(t){return t.getParam("backcolor_rows",o(t))},v=function(t){return t.getParam("forecolor_cols",r(t))},P=function(t){return t.getParam("backcolor_cols",r(t))},k=n,x=function(t){return"function"==typeof n(t)},T=tinymce.util.Tools.resolve("tinymce.util.I18n"),_=function(t,e,o,r){function n(t,e){var o="transparent"===t;return'<td class="mce-grid-cell'+(o?" mce-colorbtn-trans":"")+'"><div id="'+s+"-"+m+++'" data-mce-color="'+(t||"")+'" role="option" tabIndex="-1" style="'+(t?"background-color: "+t:"")+'" title="'+T.translate(e)+'">'+(o?"&#215;":"")+"</div></td>"}var a,l,c,i,u,m=0,s=g.DOM.uniqueId("mcearia"),d=f(o);for(d.push({text:T.translate("No color"),color:"transparent"}),a='<table class="mce-grid mce-grid-border mce-colorbutton-grid" role="list" cellspacing="0"><tbody>',l=d.length-1,i=0;i<e;i++){for(a+="<tr>",c=0;c<t;c++)a+=l<(u=i*t+c)?"<td></td>":n((u=d[u]).color,u.text);a+="</tr>"}if(r){for(a+='<tr><td colspan="'+t+'" class="mce-custom-color-btn"><div id="'+s+'-c" class="mce-widget mce-btn mce-btn-small mce-btn-flat" role="button" tabindex="-1" aria-labelledby="'+s+'-c" style="width: 100%"><button type="button" role="presentation" tabindex="-1">'+T.translate("Custom...")+"</button></div></td></tr>",a+="<tr>",c=0;c<t;c++)a+=n("","Custom color");a+="</tr>"}return a+="</tbody></table>"},A=function(t){t.addButton("forecolor",{type:"colorbutton",tooltip:"Text color",format:"forecolor",panel:{role:"application",ariaRemember:!0,html:c(t,!0),onclick:l(t,v(t))},onclick:a(t)}),t.addButton("backcolor",{type:"colorbutton",tooltip:"Background color",format:"hilitecolor",panel:{role:"application",ariaRemember:!0,html:c(t,!1),onclick:l(t,P(t))},onclick:a(t)})};t.add("textcolor",function(t){d(t),A(t)})}();